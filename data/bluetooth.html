<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Basic Configuration</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="all" href="styles.css">
    <link type="text/css" rel="stylesheet" href="tswnavbar.css" title="Side Menu CSS">
  </head>
  <body onload="getTime()" style="background-color: #1d2324; color: white;">
    <div id="tswcontainer">
      <div id="tswheader">
        <!-- start of header section: insert your logo, etc, here -->
        <p style="text-align: center; font-size: 1%; vertical-align: 210px;">
          <a href="http://the-iotfactory.com" title="The IoT Factory" target="_blank">
            <img src="The_IoT_Factory.png" alt="The IoT Factory Logo" title="Logo"
              id="logo" style="width: 215px; height: 45.3204px;">
          </a>
        </p>
        <p>&nbsp;</p>
        <p style="text-align: right; font-size: smaller;">
          <font>Boiler control by The IoT Factory ©</font>
          <font style="color:#3f9bd5;""><label id='currentDate'"></label></font>
        </p>
        <script>
          function getTime() {
            var now=new Date();
            document.getElementById("currentDate").innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+now.toLocaleDateString()+" - "+now.toLocaleTimeString()+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
            setTimeout(getTime,1000);
          }
        </script>
        <p style="text-align: center; font-size: smaller;"><br>
        </p>
      </div>
      <div id="tswsidecol">
        <div id="tswsideproper">
          <!-- start of side column: insert your navigation menu, etc, here -->
          <!-- start of hamburger menu button -->
          <script type="text/javascript">
                function tsw_expand_navmenu( )
                {
                  document.getElementById ( 'tswhamburger' ).style.display = 'none' ;
                  document.getElementById( 'tswcssbuttons' ).style.display = 'block' ;
                }
              </script> <button type="button" id="tswhamburger" title="Click to expand menu"

            onclick="tsw_expand_navmenu();">≡</button>
          <!-- end of hamburger menu button -->
          <div id="tswcssbuttons">
            <ul>
              <li><a href="index.html">Dashboard</a></li>
              <li><a href="graphs.html">Graphs</a></li>
              <li><a href="stats.html">Statistics</a></li>
              <li><a href="info.html">Global Info</a></li>
              <li><a href="basic.html">Basic configuration</a></li>
              <li><a href="cloud.html">Cloud configuration</a></li>
              <li><a href="bluetooth.html">Bluetooth configuration</a></li>
              <li><a href="console.html">Console logs</a></li>
              <li><a href="maintenance.html">Maint. & Troubleshoot</a></li>
            </ul>
          </div>
          <!-- end of side column: put your navigation menu, etc, above this line -->
        </div>
      </div>
      <div id="tswcontent">
        <div id="tswcontproper">
          <!-- start of content column: insert your content here -->
          <h1>Bluetooth Configuration</h1>
          <p></p>
          <form action="bluetooth" method="post">
            <label for="BLEIBEACON">iBeacon Configuration</label><p></p>
            <label for="BLEPROXIMITY">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proximity UUID:&nbsp;&nbsp;</label>
            <input id="BLEPROXIMITY1_id" name="BLEPROXIMITY1" pattern="^[A-Fa-f0-9]+$" minlength="8" maxlength="8" size="8" placeholder="FFFFFFFF" type="text" required title="8 HEX characters required" required value="FFFFFFFF" disabled="disabled">
            <input id="BLEPROXIMITY2_id" name="BLEPROXIMITY2" pattern="^[A-Fa-f0-9]+$" minlength="4" maxlength="4" size="4" placeholder="FFFF" type="text" required title="4 HEX characters required" required value="FFFF" disabled="disabled">
            <input id="BLEPROXIMITY3_id" name="BLEPROXIMITY3" pattern="^[A-Fa-f0-9]+$" minlength="4" maxlength="4" size="4" placeholder="FFFF" type="text" required title="4 HEX characters required"  required value="FFFF" disabled="disabled">
            <input id="BLEPROXIMITY4_id" name="BLEPROXIMITY4" pattern="^[A-Fa-f0-9]+$" minlength="4" maxlength="4" size="4" placeholder="FFFF" type="text" required title="4 HEX characters required"  required value="FFFF" disabled="disabled">
            <input id="BLEPROXIMITY5_id" name="BLEPROXIMITY5" pattern="^[A-Fa-f0-9]+$" minlength="12" maxlength="12" size="12" placeholder="FFFFFFFFFFFF" type="text" required title="12 HEX characters required"  required value="FFFFFFFFFFFF" disabled="disabled">
            <br>
            <label for="BLEMAJOR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Major:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
            <input id="BLEMAJOR_id" name="BLEMAJOR" pattern="^[0-9]+$" maxlength="5" size="5" min=0 max=65535 placeholder="65535" type="number" required value="65535" disabled="disabled">
            <label for="BLEMAJORHEX" id="BLEMAJORHEX_id">&nbsp;0xFFFF</label>
            <br>
            <label for="BLEMINOR">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Minor:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
            <input id="BLEMINOR_id" name="BLEMINOR" pattern="^[0-9]+$" maxlength="5" size="5" min=0 max=65535 placeholder="65535" type="number" required value="65535" disabled="disabled">
            <label for="BLEMINORHEX" id="BLEMINORHEX_id" >&nbsp;0xFFFF</label>
            <p></p><br><br>
            Enable Bluetooth:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <label for="Bluetooth_on_id">On</label>	
            <input name="Bluetooth_enabled" id="Bluetooth_on_id" value="on" required="required" type="radio" disabled="disabled">
             &nbsp;&nbsp;&nbsp;&nbsp;
            <label for="Bluetooth_off_id">Off</label>
            <input name="Bluetooth_enabled" id="Bluetooth_off_id" value="off" required="required" checked type="radio" disabled="disabled">
            <br><br>
            <p></p>
            <button type="reset" name="Button_Reset" id="Button_Reset_id" disabled="disabled">Reset</button>&nbsp;&nbsp;&nbsp;&nbsp;
            <button type="submit" name="Button_Send" id="Button_Send_id" onClick="return checkChanges()" disabled="disabled"><strong>Submit</strong></button>
          </form>

          <script>
            var iBeaconChanged=false;
            var auxProximity1=document.getElementById("BLEPROXIMITY1_id").value; //String
            var auxProximity2=document.getElementById("BLEPROXIMITY2_id").value; //String
            var auxProximity3=document.getElementById("BLEPROXIMITY3_id").value; //String
            var auxProximity4=document.getElementById("BLEPROXIMITY4_id").value; //String
            var auxProximity5=document.getElementById("BLEPROXIMITY5_id").value; //String
            var auxMajor=parseInt(document.getElementById("BLEMAJOR_id").value); //Number
            var auxMinor=parseInt(document.getElementById("BLEMINOR_id").value); //Number
            document.getElementById("BLEPROXIMITY1_id").addEventListener("input", updateValue);
            document.getElementById("BLEPROXIMITY2_id").addEventListener("input", updateValue);
            document.getElementById("BLEPROXIMITY3_id").addEventListener("input", updateValue);
            document.getElementById("BLEPROXIMITY4_id").addEventListener("input", updateValue);
            document.getElementById("BLEPROXIMITY5_id").addEventListener("input", updateValue);
            document.getElementById("BLEMAJOR_id").addEventListener("input", updateValue);
            document.getElementById("BLEMINOR_id").addEventListener("input", updateValue);

            function checkChanges() {
              if (auxProximity1!=document.getElementById("BLEPROXIMITY1_id").value) iBeaconChanged=true;
              if (auxProximity2!=document.getElementById("BLEPROXIMITY2_id").value) iBeaconChanged=true;
              if (auxProximity3!=document.getElementById("BLEPROXIMITY3_id").value) iBeaconChanged=true;
              if (auxProximity4!=document.getElementById("BLEPROXIMITY4_id").value) iBeaconChanged=true;
              if (auxProximity5!=document.getElementById("BLEPROXIMITY5_id").value) iBeaconChanged=true;
              if (auxMajor!=document.getElementById("BLEMAJOR_id").value) iBeaconChanged=true;
              if (auxMinor!=document.getElementById("BLEMINOR_id").value) iBeaconChanged=true;


              if (iBeaconChanged===true) {
                return confirm("The device will be reset. Do you want to continue?")
              }
              else return;
            }
            
            function updateValue(detectedEvent) { //Modify values for better reading
              //Convert to upper case for better reading
              if ( (detectedEvent.target.id==='BLEPROXIMITY1_id') || (detectedEvent.target.id==='BLEPROXIMITY2_id') || (detectedEvent.target.id==='BLEPROXIMITY3_id') ||
                   (detectedEvent.target.id==='BLEPROXIMITY4_id') || (detectedEvent.target.id==='BLEPROXIMITY5_id') ) {
                    var inputValue=detectedEvent.target.value;
                    detectedEvent.target.value=inputValue.toUpperCase();
                    //iBeaconChanged=true;
              }
              //Convert the Decimal value into HEX
              else if (detectedEvent.target.id==='BLEMAJOR_id') {
                var decimalValue=parseInt(detectedEvent.target.value);
                document.getElementById("BLEMAJORHEX_id").innerHTML="0x"+decimalValue.toString(16).toUpperCase();
                //iBeaconChanged=true;
              }
              //Convert the Decimal value into HEX
              else if (detectedEvent.target.id==='BLEMINOR_id') {
                var decimalValue=parseInt(detectedEvent.target.value);
                document.getElementById("BLEMINORHEX_id").innerHTML="0x"+decimalValue.toString(16).toUpperCase();
                //iBeaconChanged=true;
              }
            }
          </script>
          <!-- end of content column: put your content above this line --> </div>
      </div>
      <div style="clear: both;"></div>
      <div id="tswfooter">
        <!-- start of footer section: insert your copyright notice, etc, here -->
        <p style="font-size: 80%; text-align: center;">The IoT Factory ©</p>
        <p style="font-size: 55%; text-align: center;"><a href="http://the-iotfactory.com"

            title="The IoT Factory" target="_blank">http://the-iotfactory.com</a></p>
        <!-- end of footer section: insert your copyright notice, etc, above this line -->
      </div>
    </div>
  </body>
</html>